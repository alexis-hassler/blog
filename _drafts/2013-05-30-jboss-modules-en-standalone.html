---
layout: post
title: JBoss Modules en standalone
date: '2013-05-30T11:57:00.000+02:00'
author: Alexis Hassler
tags: 
modified_time: '2013-05-30T11:57:11.749+02:00'
blogger_id: tag:blogger.com,1999:blog-1829028238633284708.post-1470685143759771306
blogger_orig_url: http://blog.alexis-hassler.com/2013/05/jboss-modules-en-standalone.html
---

Depuis AS 7, JBoss remplace le classpath hiérarchique habituel par un système de modules. Je trouve ce fonctionnement particulièrement puissant pour gérer les dépendances entre librairies, au déploiement.  Ce que l'on sait moins, c'est que JBoss Module peut aussi être utilisé pour des applications autonomes. <br /><br />C'est assez simple de <b>démarrer une application avec JBoss Modules</b>. D'abord, il faut un module qui contient une classe avec une méthode main. <br /><pre class="brush:java">package org.sewatech.module.start;<br />public class Main {<br />  public static void main(String[] args) {<br />    ...<br />  }<br />}</pre>Cette classe est déclarée comme classe principale dans le fichier module.xml du module. <br /><pre class="brush:xml">&lt;module name="org.sewatech.module.start" xmlns="urn:jboss:module:1.1"&gt;<br />  &lt;main-class name="org.sewatech.module.start.Main"/&gt;<br />  &lt;resources&gt;<br />    &lt;resource-root path="start-0.1-SNAPSHOT.jar"/&gt;<br />  &lt;/resources&gt;<br />  &lt;dependencies&gt;<br />    &lt;module name="org.sewatech.module.other"/&gt;<br />    &lt;module name="javax.api"/&gt;<br />  &lt;/dependencies&gt;<br />&lt;/module&gt;<br /></pre>Ensuite, on démarre sur le jar de JBoss Modules et on indique le module de démarrage.  <br /><pre class="brush:bash">java -jar jboss-modules.jar -mp modules org.sewatech.module.start</pre>Je dois avouer que j'ai parfois du mal à me rappeler des différentes parties de la commande. Et plutôt que de mettre toutes les informations dans cette ligne de commande, on peut trouver plus pratique de <b>bootstrapper le module de démarrage</b>, ce qui consiste à faire une classe de démarrage traditionnelle qui s'occupera de démarrer le module principal.   <br /><pre class="brush:java">public class Main {<br />  public static void main(String[] args) {<br />    LocalModuleLoader loader = new LocalModuleLoader(<br />          new File[]{new File("modules")});<br />    startModule = loader.loadModule(<br />          ModuleIdentifier.fromString("org.sewatech.module.start"));<br />    startModule.run(new String[0]);<br />  }<br />}</pre>On a ainsi mis le doigt dans les JBoss Modules, en dehors de JBoss AS. Il reste probablement plein de choses intéressantes à exploiter...