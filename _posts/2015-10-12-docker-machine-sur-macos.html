---
layout: post
title: Adieu boot2docker, bonjour docker-machine
date: '2015-10-12T09:30:00.000+02:00'
author: Alexis Hassler
tags:
- boot2docker
- Docker Machine
- Docker
modified_time: '2015-12-04T10:44:47.199+01:00'
thumbnail: "//1.bp.blogspot.com/-RZxtazh67ZQ/Vg6riXgejJI/AAAAAAAAGMI/INsbXRCb6gc/s72-c/mac_docker_host.png.png"
blogger_id: tag:blogger.com,1999:blog-1829028238633284708.post-7006710715193996509
blogger_orig_url: http://blog.alexis-hassler.com/2015/10/docker-machine-sur-macos.html

---

<div>Eh oui, <b>boot2docker</b>, c'est fini. C'était sympa, tu m'as permis d'utiliser Docker là où ce n'était pas permis. Mais maintenant, tu dois laisser ta place à <b>Docker Machine</b>.<span style="color: purple;"><i> Voilà, c'est fini. Ne sois jamais amère, reste toujours sincère. T'as eu c'que t'as voulu, même si t'as pas voulu c'que t'as eu.</i></span><br /><!--more--></div><div>Docker ne fonctionne nativement que sur Linux (du moins pour l'instant). Pour être plus précis, Docker fonctionne sur un modèle client-serveur où  l'outil de commande (client) marche sous Linux, Windows et MacOS et le  démon (serveur) ne fonctionne que sous Linux. Donc pour l'utiliser sur MacOS, ou d'autres systèmes encore plus exotiques, il faut installer ce démon dans une machine virtuelle. </div><div class="separator" style="clear: both; text-align: center;"><a href="https://docs.docker.com/installation/mac/" style="margin-left: 1em; margin-right: 1em;" target="_blank"><img alt="Docker on MacOS" border="0" height="320" src="//1.bp.blogspot.com/-RZxtazh67ZQ/Vg6riXgejJI/AAAAAAAAGMI/INsbXRCb6gc/s320/mac_docker_host.png.png" width="251" /></a></div><div>C'est ce que fait <a href="http://boot2docker.io/" target="_blank">boot2docker</a>. L'outil nous télécharge une machine virtuelle VirtualBox légère, qui embarque le démon docker. Il nous permet de la piloter cette VM, essentiellement pour la démarrer et l'arrêter. Sur MacOS, on peut télécharger l'<i>installer</i> de boot2docker et l'installer manuellement, ou passer par <a href="http://brew.sh/" target="_blank">Homebrew</a>. </div><pre class="brush:bash">brew install docker<br />brew install boot2docker<br /></pre><div style="background-color: #0691d0; color: white; font-size: x-large; line-height: 400%; margin: 10px 50px; text-align: center;"><b>Mais ça, c'était avant.</b></div><div>Aujourd'hui, boot2docker est déprécié, au profit de <a href="https://docs.docker.com/machine/" target="_blank">Docker Machine</a>. </div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.docker.com/sites/default/files/products/docker_machine.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="200" src="https://www.docker.com/sites/default/files/products/docker_machine.png" width="168" /></a></div><div>Le but de Docker Machine est plus vaste que boot2docker. Il est là pour installer Docker sur une machine distante et configurer notre client pour qu'il y accède. Par machine distante, on entend chez un des prestataires cloud supportés (Amazon AWS, Google Compute Engine, Digital Ocean,...) ou sur un moteur de virtualisation supporté (VirtualBox, VMware Fusion,...). Docker Machine avec son driver VirtualBox remplace donc boot2docker. </div><div>Là aussi, il y a deux façons de l'installer. La documentation officielle préconise d'utiliser la Docker Toolbox, qui contient aussi Docker, Docker Compose et Kitematic. Personnellement, je reste fidèle à <a href="http://brew.sh/" target="_blank">Homebrew</a>. </div><pre class="brush:bash">brew install docker-machine<br /></pre><div>En écoutant les <a href="https://lescastcodeurs.com/" target="_blank">Cast Codeurs</a>, j'ai découvert que Docker Toolbox était disponible avec <a href="http://caskroom.io/" target="_blank">Homebrew Cask</a> :<br /><pre class="brush:bash">brew cask install dockertoolbox</pre>Une fois que tout est installé, je peux créer ma VM. </div><pre class="brush:bash">docker-machine create -d virtualbox docker-vm<br />eval "$(docker-machine env docker-vm)" </pre><div>Oui, mais si vous avez bien suivi, avant j'avais boot2docker, pour lequel j'avais déjà une VM avec plein d'images. Ce serait donc bien de récupérer tout ça. Et bien c'est prévu dans Docker Machine. </div><pre class="brush:bash">docker-machine create -d virtualbox --virtualbox-import-boot2docker-vm boot2docker-vm<br />eval "$(docker-machine env boot2docker-vm)"</pre>Les commandes ont un peu changé, au lieu de <i>up</i> et <i>down,</i> on a <i>start</i> et <i>stop,</i> ce qui est plus cohérent avec les commandes Docker. <br /><pre class="brush:bash">docker-machine start<br />docker-machine stop<br /></pre><div><div>Il ne me reste plus qu'à désinstaller boot2docker. </div><pre class="brush:bash">boot2docker destroy<br />brew remove boot2docker<br /></pre><span style="color: purple;"><i>C'est fini...hum, c'est fini...&nbsp;</i></span><br /><br /><br /></div>