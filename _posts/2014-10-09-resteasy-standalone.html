---
layout: post
title: Démarrer RESTEasy en mode standalone
date: '2014-10-09T17:15:00.002+02:00'
author: Alexis Hassler
tags:
- JAX-RS
- JavaEE
- resteasy
modified_time: '2015-12-04T11:28:08.813+01:00'
thumbnail: http://4.bp.blogspot.com/-657P8g-UT1U/VmFqk8wVk7I/AAAAAAAAGVY/9HrNjReLYOM/s72-c/resteasy_logo_256x.png
blogger_id: tag:blogger.com,1999:blog-1829028238633284708.post-8868373281019162786
blogger_orig_url: http://blog.alexis-hassler.com/2014/10/resteasy-standalone.html

---

<div class="separator" style="clear: both; text-align: center;"><a href="//4.bp.blogspot.com/-657P8g-UT1U/VmFqk8wVk7I/AAAAAAAAGVY/9HrNjReLYOM/s1600/resteasy_logo_256x.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-657P8g-UT1U/VmFqk8wVk7I/AAAAAAAAGVY/9HrNjReLYOM/s1600/resteasy_logo_256x.png" /></a></div><br /><div class="separator" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em; text-align: center;"><br /></div><br />Dans un des premiers billets sur ce blog, je montrais comment démarrer <a href="http://blog.alexis-hassler.com/2010/03/jrebel-avec-openjdk-et-grizzly.html" target="_blank">Jersey en mode autonome</a>, avec Grizzly, avec un peu de JRebel. J'ai voulu faire une mise en place similaire avec <a href="http://resteasy.jboss.org/" target="_blank">RESTEasy</a>, l'implémentation de JAX-RS de JBoss.<br /><br />RESTEasy n'a pas de mode autonome, il doit être utilisé avec un serveur Web. Il est intégré en standard dans WildFly, mais peut aussi être intégré à d'autres serveurs, comme Tomcat, Undertow ou le serveur Web du JDK d'Oracle. J'aime bien cette dernière possibilité car elle ne nécessite pas d'installation supplémentaire et donc peut facilement être utilisée pour un prototype ou pour des tests.<br /><br /><!--more--><div class="separator" style="clear: both;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both;"><span style="text-align: left;">La première étape est la définition de mon classpath. Dans mon fichier pom.xml, je déclare des dépendances vers org.jboss.resteasy:</span><span class="s4" style="text-align: left;">resteasy</span><span class="s1" style="text-align: left;">-jaxrs et&nbsp;</span><span style="text-align: left;">org.jboss.resteasy:</span><span class="s5" style="text-align: left;">resteasy</span><span style="text-align: left;">-</span><span class="s5" style="text-align: left;">jdk</span><span style="text-align: left;">-</span><span class="s5" style="text-align: left;">http</span><span style="text-align: left;">. La première est le coeur de RESTEasy avec l'API JAX-RS et la seconde est l'extension permettant l'intégration avec le serveur Web du JDK. Je ne les ai pas mis ici, mais j'ai aussi ajouté des dépendances vers les providers pour le support de JSON (org.jboss.resteasy:</span><span class="s1" style="text-align: left;">resteasy</span><span style="text-align: left;">-</span><span class="s1" style="text-align: left;">jackson</span><span style="text-align: left;">-provider) et celui des listes (org.jboss.resteasy:</span><span class="s1" style="text-align: left;">resteasy</span><span style="text-align: left;">-</span><span class="s1" style="text-align: left;">jaxb</span><span style="text-align: left;">-provider).</span></div><br /><pre class="brush:xml">&lt;dependencies&gt;<br />    &lt;dependency&gt;<br />        &lt;groupId&gt;org.jboss.resteasy&lt;/groupId&gt;<br />        &lt;artifactId&gt;resteasy-jaxrs&lt;/artifactId&gt;<br />        &lt;version&gt;${resteasy.version}&lt;/version&gt;<br />    &lt;/dependency&gt;<br />    &lt;dependency&gt;<br />        &lt;groupId&gt;org.jboss.resteasy&lt;/groupId&gt;<br />        &lt;artifactId&gt;resteasy-jdk-http&lt;/artifactId&gt;<br />        &lt;version&gt;${resteasy.version}&lt;/version&gt;<br />    &lt;/dependency&gt;<br />    &lt;!-- ... --&gt;<br />&lt;/dependencies&gt;<br /></pre><div class="p3"><span class="s2"><br /></span></div><div class="p3"><span class="s2">L'étape suivante est la création d'une classe de démarrage avec une méthode main. Dans cette méthode, on initialise le HttpServer du JDK, en l'associant à REASTEasy grâce à la classe&nbsp;</span>HttpContextBuilder fournie par l'extension.</div><div class="p3"><span class="s2"><br /></span></div><div class="p3"><span class="s2"></span></div><div class="p1">Dans l'extrait de code ci-dessous, seule la classe HttpContextBuilder vient de REATEasy. Sa méthode bind() initialise et configure le moteur JAX-RS, associe les classes de ressources JAX-RS et passe tout ça dans un handler de HttpServer.&nbsp;</div><div><br /></div><pre class="brush:java">    HttpServer server = HttpServer.create(new InetSocketAddress(7000), 1);<br />    HttpContextBuilder contextBuilder = new HttpContextBuilder();<br />    contextBuilder.getDeployment()<br />                  .getActualResourceClasses()<br />                  .add(TextEndpoint.class);<br />    HttpContext context = contextBuilder.bind(server);<br />    server.start();<br /></pre><div class="p1"><br /></div><div class="p1">L'unique ressource référencée est MessageEndpoint que j'ai implémentée et qui répond aux requêtes GET pour récupérer un message unique ou tous les messages. Vous pourrez retrouver son code source sur <a href="https://github.com/hasalex/resteasy-demo" target="_blank">Github</a>, avec l'exemple complet.</div><div class="p1"><br /></div><div>HttpServer est démarré, en écoute sur le port 7000. On peut tester avec cURL : <br /><br /></div><pre class="brush:bash">curl -w "\n" -H "accept:application/json" http://localhost:7000/message/1</pre><div><br />ou<br /><br /></div><pre class="brush:bash">curl -w "\n" -H "accept:application/json" http://localhost:7000/message</pre><div>Voilà, mon serveur JAX-RS est en place. La prochaine étape sera d'englober ça dans une Rule pour jUnit, afin d'utiliser mon serveur dans des tests.</div><div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://design.jboss.org/resteasy/banner/images/resteasy_banner.png" height="76" width="640" /></div></div><div></div>