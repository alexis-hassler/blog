---
layout: post
title: Environnement de développement pour GAE
date: '2010-02-08T20:59:00.178+01:00'
author: Alexis Hassler
tags:
- GoogleAppEngine
modified_time: '2010-02-09T00:19:11.741+01:00'
thumbnail: http://4.bp.blogspot.com/_0XT5UpDEEfE/S3BBj6_WvxI/AAAAAAAABZQ/ijxshF1IEgQ/s72-c/gae-plugin.png
blogger_id: tag:blogger.com,1999:blog-1829028238633284708.post-5071319225012043295
blogger_orig_url: http://blog.alexis-hassler.com/2010/02/environnement-de-developpement-pour-gae.html

---

Avant de commencer le projet, il faut que je constitue un environnement de développement. Même si, pour l'instant, je n'ai pas besoin d'un environnement complet, avec outils de suivi de qualité ou intégration continue, il faut au moins que j'évalue les capacités des outils de développement, en me concentrant sur Netbeans et Eclipse, avec ou sans Maven ou Ant.<br /><br />Il est possible de développer avec des outils rudimentaires : un JDK 5 ou 6, le SDK et un éditeur de texte. J'ai fait quelques essais dont j'ai rendu compte sur <a href="http://www.jtips.info/index.php?title=GoogleAppEngine/SDK">JTips</a>. Ces essais m'ont juste servi à comprendre le fonctionnement du SDK avant d'étudier l'intégration avec les environnements de développement.<br /><!--more--><br /><h4>Intégration avec Eclipse</h4><h5>Installation du plug-in</h5>Google fournit un <a href="http://code.google.com/intl/fr/appengine/docs/java/tools/eclipse.html">plugin Eclipse</a> pour GAE. Il y a une adresse d'update site pour chaque version d'Eclipse. Par exemple, pour Eclipse 3.5, il faut ajouter le site suivant dans Eclipse :<br />&nbsp;&nbsp;&nbsp; <code>http://dl.google.com/eclipse/plugin/3.5</code> <br />Le site d'update contient le plugin, l'App Engine SDK et GWT. Seul le premier est indispensable. Le SDK peut être installé de façon autonome et GWT ne sert pas forcément. J'ai donc installé le plugin tout seul ; tout s'est bien passé, du moins au deuxième essai.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_0XT5UpDEEfE/S3BBj6_WvxI/AAAAAAAABZQ/ijxshF1IEgQ/s1600-h/gae-plugin.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/_0XT5UpDEEfE/S3BBj6_WvxI/AAAAAAAABZQ/ijxshF1IEgQ/s400/gae-plugin.png" width="365" /></a></div>Le plugin ajoute les éléments suivants dans Eclipse :<br /><ul><li>un type de projet : Google / Web Application Project,</li><li>une vue : Google / Development Mode,</li><li>une configuration au niveau du workspace, pour spécifier la localisation du ou des SDK(s),</li><li>une configuration au niveau du projet, pour choisir le SDK et préciser l'id et la version de l'application,</li><li>des actions accessibles par le menu contextuel, en particulier pour déployer l'application,</li><li>une action d'exécution "Run As / Web Application".</li></ul><h5>Création du projet </h5>Une fois le plugin installé, il faut créer un <i>Google / Web Application Project</i> et spécifier la localisation du SDK qu'Eclipse utilisera.<br /><span id="goog_1265645033393"></span><span id="goog_1265645033394"></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_0XT5UpDEEfE/S3BK455BjAI/AAAAAAAABZg/SoOmiGizLw0/s1600-h/GAE-WebApplicationProject+.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://3.bp.blogspot.com/_0XT5UpDEEfE/S3BK455BjAI/AAAAAAAABZg/SoOmiGizLw0/s400/GAE-WebApplicationProject+.png" width="391" /></a></div>Le projet ressemble à un classique <i>Dynamic Web Project</i>, à ceci prêt que le répertoire war remplace WebContent et qu'une servlet d'exemple est créée. On remarque quelques fichiers supplémentaires :<br /><ul><li><code>src/log4j.properties</code> pour les traces de DataNucleus via Log4J </li><li><code>src/META-INF/jdoconfig.xml</code> pour la persistance JDO</li><li><code>war/WEB-INF/logging.properties</code> pour les traces de DataNucleus via java.util.logging </li><li><code>war/WEB-INF/appengine-web.xml</code> pour la configuration de l'application</li></ul>L'application a aussi quelques librairies jar pour les API App Engine, JDO, JPA et JTA, ainsi que pour la persistance par DataNucleus.<br /><h5>Configuration de l'application</h5>Avant de pouvoir déployer l'application, il faut renseigner l'identifiant et la version de notre application. Ceci peut se faire de façon standard dans le fichier <code>appengine-web.xml</code> ou dans la configuration du projet ; les informations sont synchronisées.<br /><h5>Lancement de l'application</h5>Avant de déployer, il faut aussi pouvoir tester l'application. Je ne parle pas encore de tests unitaires automatisés, mais juste de pouvoir exécuter localement l'application et d'afficher les pages dans mon navigateur.<br />Il faut pour cela exécuter le projet "Run As / Web Application", qui lance le serveur localement sur le port 8888. L'accès aux pages se fait donc par l'URL http://localhost:8888/.<br />Le port du serveur local peut être modifié dans les "Run Configurations".<br /><h5>Déploiement</h5>Enfin, nous pouvons déployer notre application, ou plutôt la dernière version de l'application, sur le serveur App Engine. On peut utiliser le menu contextuel ou la barre d'outils "Deploy App Engine Project".<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://code.google.com/appengine/docs/python/images/transform_before.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://code.google.com/appengine/docs/python/images/transform_before.jpg" /></a></div><h4>Intégration avec Netbeans </h4>Pour travailler avec Netbeans, j'ai installé Netbeans 6.8, avec les dernières mises à jour, et j'ai utilisé le <a href="http://kenai.com/projects/nbappengine/pages/Home">plug-in fourni dans Kenai</a>. On verra dans l'avenir proche s'il reste sur Kenai ou s'il doit migrer vers java.net. Quelques indices sont peu encourageants sur la vie du projet : les dernières mises à jour datent de 4 mois et la version 1.3 du SDK n'est pas encore officiellement supportée. <br /><h5>Installation du plug-in</h5>L'installation se passe en douceur : j'ai installé les modules Google à partir de l'URL indiquée. J'ai ensuite configuré mon environnement en indiquant à Netbeans la localisation du SDK, via le menu "Tools / Servers".<br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_0XT5UpDEEfE/S3B5-FvH9JI/AAAAAAAABaA/r7YkhGesqI4/s1600-h/gea-nbserver.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="246" src="http://2.bp.blogspot.com/_0XT5UpDEEfE/S3B5-FvH9JI/AAAAAAAABaA/r7YkhGesqI4/s400/gea-nbserver.png" width="400" /></a></div>Le plugin demande le port du serveur local lors de son ajout. En revanche, je n'ai pas trouvé comment changer ce port dans Netbeans. La seule solution que j'ai trouvée a été de modifier la valeur du port dans le fichier <user_home><code>.netbeans/6.8/config/J2EE/InstalledServers/.nbattrs</code></user_home><user_home>. </user_home><br /><h5>Création du projet</h5>Apparement, il n'y a pas de template de projet spécifique à App Engine. Je démarre donc avec un classique "Java Web / Web Application". En fait, à partir du moment où on choisit Google App Engine comme serveur, le plugin inclut les librairies et crée un fichier <code>appengine-web.xml</code> minimal. <br /><h5>Lancement de l'application</h5>Pour lancer l'application, un Run classique fonctionne parfaitement. Il lance le serveur local puis, selon la configuration du projet, ouvre la page d'accueil dans un navigateur.<br />On peut aussi démarrer le serveur depuis l'onglet Services.<br /><h5>Déploiement</h5>Le déploiement se fait par le menu contextuel "Deploy to Google App Engine".<br /><h4>Intégration avec IDEA</h4>Là, je m'avance un peu car je n'ai pas de licence IDEA. CE sera pour plus tard, si tout va bien.<br /><h4></h4><h4>Intégration avec Ant</h4>Le SDK fournit un ensemble de tâches Ant dans le fichier <code><sdk_home>config/user/ant-macros.xml</sdk_home></code><sdk_home>. On y trouve en particulier les tâches suivantes :</sdk_home><br /><ul><li><code>dev_appserver</code> pour démarrer le serveur local</li><li><code>appcfg</code>pour déployer l'application</li></ul>La documentation sur l'utilisation de <a href="http://code.google.com/intl/fr/appengine/docs/java/tools/ant.html">Ant avec App Engine</a> me semble pas mal, avec un exemple complet.<br /><h4></h4><h4>Intégration avec Maven</h4>Le support de Maven n'est pas natif dans le SDK. D'ailleurs, les premières expériences d'<a href="http://blog.loof.fr/2009/04/appengine-java-refractaire-maven.html">association entre les Maven et GAE</a> semblent assez négatifs. Depuis cette expérience, les choses semblent évoluer, avec l'apparition d'un <a href="http://code.google.com/p/maven-gae-plugin/">plugin</a> indépendant. En fouinant sur le Web, on peut aussi trouver des références à un <a href="http://dmakariev.blogspot.com/2010/01/jsf-20-with-spring-3-and-spring.html">gae-archetype</a> ou à des <a href="http://www.salientpoint.com/blog/?p=480">procédures manuelles</a>.<br />Bref, la situation n'est pas très claire...<br /><h4>Conclusion</h4>Comme j'ai envie de bien organiser mon projet, je suis assez motivé par l'utilisation de Maven, mais au vu de la situation actuelle, j'ai l'impression qu'il y a du travail. Je vais donc me dépêcher d'attendre.<br />Donc, dans l'étape d'investigation et de prototypage, je vais me contenter d'un IDE avec son plugin. Pour l'instant, je n'ai pas vu de différence flagrante entre Eclipse et Netbeans ; il faudra que j'approfondisse, en comparant le support des fonctionnalités avancées, comme la persistance. Mon choix initial sera juste celui de l'outil que j'ai l'habitude d'utiliser et qui bénéficie du support direct de Google : je vais donc commencer avec Eclipse, et je me reposerai la question plus tard.